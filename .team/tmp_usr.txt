REQUIREMENTS (enriched with market research):
{
 "project_name": "oidc-sms-test-infrastructure",
 "summary": "Set up mock Redis infrastructure for OIDC tests and add comprehensive unit tests for Turkish phone number normalization",
 "functional_requirements": [
  {
   "id": "FR-001",
   "title": "Mock Redis Setup for OIDC Tests"
  },
  {
   "id": "FR-002",
   "title": "Turkish Phone Normalization Unit Tests"
  },
  {
   "id": "FR-003",
   "title": "Test Helper Functions"
  },
  {
   "id": "FR-M004",
   "title": "AI Agent Identity Management"
  },
  {
   "id": "FR-M005",
   "title": "GenAI Attack Detection"
  },
  {
   "id": "FR-M006",
   "title": "Automated IGA with AI Policy Recommendations"
  },
  {
   "id": "FR-M007",
   "title": "Full Passwordless Architecture"
  },
  {
   "id": "FR-M008",
   "title": "Continuous Authentication Engine"
  },
  {
   "id": "FR-M009",
   "title": "Identity Breach Detection & Response (IBDR)"
  }
 ],
 "affected_services": [
  "identity-service"
 ],
 "implementation_phases": [
  {
   "phase": 1,
   "name": "Redis Mock Setup",
   "tasks": [
    "Audit internal/oauth/oidc_test.go:312 for Redis usage patterns",
    "Choose miniredis vs testcontainers based on Redis feature requirements",
    "Implement mock Redis setup in test helper",
    "Update OIDC tests to use mock Redis",
    "Verify tests pass without external Redis"
   ]
  },
  {
   "phase": 2,
   "name": "Phone Normalization Tests",
   "tasks": [
    "Read internal/sms/providers_tr.go to understand normalizePhoneTR",
    "Create test file internal/sms/providers_tr_test.go",
    "Implement table-driven tests for 90XXXXXXXXXX preservation",
    "Implement tests for 0XXXXXXXXXX to 90XXXXXXXXXX conversion",
    "Implement tests for 5XXXXXXXXX to 905XXXXXXXXX conversion",
    "Add edge case tests (empty, invalid length, non-numeric)",
    "Verify >80% coverage"
   ]
  },
  {
   "phase": 3,
   "name": "Documentation & Cleanup",
   "tasks": [
    "Add test documentation comments",
    "Update TODO at internal/oauth/oidc_test.go:312 as resolved",
    "Run full test suite to ensure no regressions"
   ]
  }
 ]
}

MARKET ANALYSIS:
{
 "competitor_summary": [
  {
   "name": "Microsoft Entra ID",
   "strengths": [
    "Deep Microsoft 365 ecosystem integration",
    "Real-time risk-based access controls",
    "Scales to 8 billion authentications daily",
    "AI agent identity management (10,000+ agents per pilot)",
    "Conditional Access with pre-built templates",
    "Passwordless authentication (FIDO2/WebAuthn)",
    "Identity Protection with behavioral analytics",
    "Privileged Identity Management (PIM)",
    "SOC 2 Type II, ISO 27001, FedRAMP certified"
   ],
   "weaknesses": [
    "Vendor lock-in to Microsoft ecosystem",
    "Complex licensing tiers",
    "Expensive for small-to-medium enterprises",
    "Limited flexibility in heterogeneous environments"
   ],
   "pricing_model": "Per-user per-month licensing (Free P1, P2, A3, A5 tiers); expensive for enterprise features"
  },
  {
   "name": "Okta",
   "strengths": [
    "Best-in-class SSO across heterogeneous environments",
    "Adaptive MFA with fully customizable flows",
    "Flexible policy building engine",
    "Neutral platform (no vendor lock-in)",
    "Large app integration catalog (7000+)",
    "Okta Identity Cloud advanced features",
    "Lifecycle Management automation",
    "API-first design"
   ],
   "weaknesses": [
    "Can be complex to configure optimally",
    "Premium features require expensive tiers",
    "Some reporting limitations",
    "Historical security concerns (2022 breach)"
   ],
   "pricing_model": "Per-user per-month; multiple tiers (OIE, OEE); typically $2-30+ per user monthly"
  },
  {
   "name": "Cisco Duo",
   "strengths": [
    "Simple deployment model",
    "Strong device posture assessment",
    "Zero-trust access to on-prem apps",
    "Excellent for MFA-only use cases",
    "Phishing-resistant MFA",
    "Trusted endpoint verification"
   ],
   "weaknesses": [
    "Limited full IAM capabilities",
    "Requires additional products for complete identity governance",
    "Less flexible policy engine than 

PROJECT CONTEXT (from CLAUDE.md):
# CLAUDE.md - OpenIDX Development Guide

## Project Overview

OpenIDX is an open-source Zero Trust Access Platform (ZTAP) that provides enterprise-grade Identity and Access Management. It competes with commercial solutions like Microsoft Entra ID, Okta, and Duo while offering 70-80% cost savings.

## Architecture

```
┌─────────────────────────────────────────────────────────────────┐
│                     API Gateway (APISIX)                        │
└─────────────────────────────────────────────────────────────────┘
                                │
    ┌───────────────────────────┼───────────────────────┐
    │                           │                       │
┌───▼───┐  ┌───────▼───────┐  ┌───▼───┐  ┌───────▼─────┐
│Identity│  │  Governance  │  │Provis-│  │    Audit   │
│Service │  │   Service    │  │ioning │  │   Service  │
└────────┘  └──────────────┘  └───────┘  └────────────┘
    │               │              │             │
    └───────────────┼──────────────┴─────────────┘
                    │
         ┌──────────▼──────────┐
         │  Policy Engine (OPA)│
         └─────────────────────┘
                    │
    ┌───────────────┼───────────────┐
    │               │               │
┌───▼───┐     ┌─────▼─────┐   ┌─────▼─────┐
│Postgres│    │   Redis   │   │Elasticsearch│
└────────┘    └───────────┘   └────────────┘
```

## Tech Stack

### Backend (Go 1.22+)
- **Framework**: Gin (HTTP router)
- **Database**: PostgreSQL with pgx driver
- **Cache**: Redis with go-redis
- **Logging**: Zap
- **Config**: Viper
- **JWT**: golang-jwt/v5

### Frontend (React 18+)
- **Framework**: React with TypeScript
- **Build**: Vite
- **Styling**: Tailwind CSS
- **State**: Zustand + React Query
- **UI**: Radix UI primitives
- **Auth**: OpenIDX OAuth (PKCE)

### Infrastructure
- **OAuth/OIDC**: Native OpenIDX OAuth Service
- **API Gateway**: Apache APISIX
- **Policy Engine**: Open Policy Agent (OPA)
- **Container**: Docker + Kub

EXISTING FILES:
internal/access/app_publish.go
internal/access/browzer_config.go
internal/access/browzer_targets.go
internal/access/context_evaluator.go
internal/access/continuous_verify.go
internal/access/device_health.go
internal/access/feature_handlers.go
internal/access/feature_manager.go
internal/access/guacamole.go
internal/access/health_handlers.go
internal/access/multi_idp.go
internal/access/platform_certs.go
internal/access/policy_dsl.go
internal/access/posture.go
internal/access/service.go
internal/access/temp_access.go
internal/access/unified_audit.go
internal/access/ziti_auth_handlers.go
internal/access/ziti_browzer.go
internal/access/ziti_browzer_handlers.go
internal/access/ziti_config_handlers.go
internal/access/ziti_discovery.go
internal/access/ziti_fabric.go
internal/access/ziti_fabric_handlers.go
internal/access/ziti.go
internal/access/ziti_handlers.go
internal/access/ziti_hardening.go
internal/access/ziti_session_handlers.go
internal/access/ziti_sync_handlers.go
internal/access/ziti_terminator_handlers.go
internal/access/ziti_user_sync.go
internal/admin/admin_audit.go
internal/admin/ai_agents.go
internal/admin/ai_recommendations.go
internal/admin/analytics_enhanced.go
internal/admin/attestation.go
internal/admin/audit_archival.go
internal/admin/auth_handler.go
internal/admin/bulk_import_export.go
internal/admin/bulk_operations.go
internal/admin/config.go
internal/admin/dashboard_enhanced.go
internal/admin/dashboard.go
internal/admin/deprovisioning.go
internal/admin/developer.go
internal/admin/email_templates.go
internal/admin/error_catalog.go
internal/admin/errors_helper.go
internal/admin/federation.go
internal/admin/handler.go

Design the complete solution. Include market-driven features where priority is critical/high. Be specific about file paths, function names, schemas, implementation order.
