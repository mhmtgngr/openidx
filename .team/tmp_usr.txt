REQUIREMENTS (enriched with market research):
{
 "project_name": "Session DeleteByUser Error Handling",
 "summary": "Fix the DeleteByUser method in the session service to return a proper domain error when attempting to delete sessions for a non-existent user or a user with no sessions, instead of returning nil.",
 "functional_requirements": [
  {
   "id": "FR-001",
   "title": "DeleteByUser should return error for no sessions"
  },
  {
   "id": "FR-002",
   "title": "Add test case for non-existent user deletion"
  },
  {
   "id": "FR-003",
   "title": "Preserve existing successful deletion behavior"
  },
  {
   "id": "FR-M004",
   "title": "AI-Based Anomaly Detection"
  },
  {
   "id": "FR-M005",
   "title": "Passwordless Authentication"
  },
  {
   "id": "FR-M006",
   "title": "Privileged Access Management (PAM)"
  },
  {
   "id": "FR-M007",
   "title": "Device Trust Assessment"
  },
  {
   "id": "FR-M008",
   "title": "Just-in-Time Access"
  },
  {
   "id": "FR-M009",
   "title": "Machine Identity Management"
  },
  {
   "id": "FR-M010",
   "title": "Enhanced Audit Reports"
  },
  {
   "id": "FR-M011",
   "title": "Risk-Based Adaptive Authentication"
  }
 ],
 "affected_services": [
  "identity-service"
 ],
 "implementation_phases": [
  {
   "phase": 1,
   "name": "Code Analysis",
   "tasks": [
    "Review current DeleteByUser implementation in internal/auth/session.go",
    "Identify all callers of DeleteByUser method",
    "Review existing error handling patterns in session service"
   ]
  },
  {
   "phase": 2,
   "name": "Implementation",
   "tasks": [
    "Modify DeleteByUser to check if sessionIDs slice is empty and return ErrSessionNotFound",
    "Add test case for deleting sessions of non-existent user",
    "Update any test cleanup code that calls DeleteByUser"
   ]
  },
  {
   "phase": 3,
   "name": "Testing",
   "tasks": [
    "Run unit tests for session service",
    "Run integration tests for identity service",
    "Verify no regressions in existing functionality"
   ]
  }
 ]
}

MARKET ANALYSIS:
{
 "competitor_summary": [
  {
   "name": "Microsoft Entra ID",
   "strengths": [
    "Deep Microsoft 365 ecosystem integration",
    "Batteries included MFA and Conditional Access",
    "Automated identity lifecycle management",
    "Guest user access management",
    "Role-based access control with separation of duties",
    "Enterprise-grade compliance certifications"
   ],
   "weaknesses": [
    "Vendor lock-in to Microsoft ecosystem",
    "Less flexible for non-Microsoft tools",
    "Complex pricing bundled with other products",
    "Higher total cost for organizations already invested in Microsoft"
   ],
   "pricing_model": "Starts at $93/user/month with Entra Suite bundle, often bundled with Microsoft 365 subscriptions"
  },
  {
   "name": "Okta",
   "strengths": [
    "Superior SSO across heterogeneous applications",
    "Excellent support for non-Microsoft environments",
    "Adaptive MFA with custom policies",
    "Detailed policy configuration options",
    "Flexible platform integration"
   ],
   "weaknesses": [
    "Can be expensive for large deployments",
    "Integration complexity varies by application",
    "Less seamless in Microsoft-centric environments"
   ],
   "pricing_model": "Tiered pricing typically $50-150+/user/month depending on features"
  },
  {
   "name": "\u817e\u8baf\u4e91 IOA",
   "strengths": [
    "X-SDP enhanced architecture",
    "Dynamic policy engine with AI behavior analysis",
    "Supports million-level concurrency",
    "Policy latency <50ms",
    "Strong performance metrics"
   ],
   "weaknesses": [
    "Primarily focused on Chinese market",
    "Less global brand recognition",
    "Documentation may not be English-first"
   ],
   "pricing_model": "Regional cloud provider pricing model"
  },
  {
   "name": "\u6df1\u4fe1\u670d aTrust",
   "strengths": [
    "Active defense X-Performance RASP protection",
    "Anti-middleman attacks",
    "Million-level concurrency support",
    "Intelligent threat closed-loop",
    "Federat

PROJECT CONTEXT (from CLAUDE.md):
# CLAUDE.md - OpenIDX Development Guide

## Project Overview

OpenIDX is an open-source Zero Trust Access Platform (ZTAP) that provides enterprise-grade Identity and Access Management. It competes with commercial solutions like Microsoft Entra ID, Okta, and Duo while offering 70-80% cost savings.

## Architecture

```
┌─────────────────────────────────────────────────────────────────┐
│                     API Gateway (APISIX)                        │
└─────────────────────────────────────────────────────────────────┘
                                │
    ┌───────────────────────────┼───────────────────────┐
    │                           │                       │
┌───▼───┐  ┌───────▼───────┐  ┌───▼───┐  ┌───────▼─────┐
│Identity│  │  Governance  │  │Provis-│  │    Audit   │
│Service │  │   Service    │  │ioning │  │   Service  │
└────────┘  └──────────────┘  └───────┘  └────────────┘
    │               │              │             │
    └───────────────┼──────────────┴─────────────┘
                    │
         ┌──────────▼──────────┐
         │  Policy Engine (OPA)│
         └─────────────────────┘
                    │
    ┌───────────────┼───────────────┐
    │               │               │
┌───▼───┐     ┌─────▼─────┐   ┌─────▼─────┐
│Postgres│    │   Redis   │   │Elasticsearch│
└────────┘    └───────────┘   └────────────┘
```

## Tech Stack

### Backend (Go 1.22+)
- **Framework**: Gin (HTTP router)
- **Database**: PostgreSQL with pgx driver
- **Cache**: Redis with go-redis
- **Logging**: Zap
- **Config**: Viper
- **JWT**: golang-jwt/v5

### Frontend (React 18+)
- **Framework**: React with TypeScript
- **Build**: Vite
- **Styling**: Tailwind CSS
- **State**: Zustand + React Query
- **UI**: Radix UI primitives
- **Auth**: OpenIDX OAuth (PKCE)

### Infrastructure
- **OAuth/OIDC**: Native OpenIDX OAuth Service
- **API Gateway**: Apache APISIX
- **Policy Engine**: Open Policy Agent (OPA)
- **Container**: Docker + Kub

EXISTING FILES:
internal/access/app_publish.go
internal/access/browzer_config.go
internal/access/browzer_targets.go
internal/access/context_evaluator.go
internal/access/continuous_verify.go
internal/access/device_health.go
internal/access/feature_handlers.go
internal/access/feature_manager.go
internal/access/guacamole.go
internal/access/health_handlers.go
internal/access/multi_idp.go
internal/access/platform_certs.go
internal/access/policy_dsl.go
internal/access/posture.go
internal/access/service.go
internal/access/temp_access.go
internal/access/unified_audit.go
internal/access/ziti_auth_handlers.go
internal/access/ziti_browzer.go
internal/access/ziti_browzer_handlers.go
internal/access/ziti_config_handlers.go
internal/access/ziti_discovery.go
internal/access/ziti_fabric.go
internal/access/ziti_fabric_handlers.go
internal/access/ziti.go
internal/access/ziti_handlers.go
internal/access/ziti_hardening.go
internal/access/ziti_session_handlers.go
internal/access/ziti_sync_handlers.go
internal/access/ziti_terminator_handlers.go
internal/access/ziti_user_sync.go
internal/admin/admin_audit.go
internal/admin/ai_agents.go
internal/admin/ai_recommendations.go
internal/admin/analytics_enhanced.go
internal/admin/attestation.go
internal/admin/audit_archival.go
internal/admin/auth_handler.go
internal/admin/bulk_import_export.go
internal/admin/bulk_operations.go
internal/admin/config.go
internal/admin/dashboard_enhanced.go
internal/admin/dashboard.go
internal/admin/deprovisioning.go
internal/admin/developer.go
internal/admin/email_templates.go
internal/admin/error_catalog.go
internal/admin/errors_helper.go
internal/admin/federation.go
internal/admin/handler.go

Design the complete solution. Include market-driven features where priority is critical/high. Be specific about file paths, function names, schemas, implementation order.
